# Общая информация

Используются для вывода страниц, блоков, виджетов и т.д.

## Имена видов

Под именем вида понимается его расположение в директории `views` без формата. Например имя вида `views/pages/home.php` это `pages/home`.

Имя вида конкретного типа подразумевает его расположение в директории видов этого типа. Например имя `виджета` с файлом `views/widgets/users/mini-profle.php` это `users/mini-profile` (виджеты находятся в папке `views/widgets`, это задано в классе вида `Widget`).

## Форматы видов

Каждый тип вида определяет форматы, которые он поддерживает. Какие именно - смотреть в документации по конкретным типам. Обычно это `.php` и `.html`.

Если вид не содержит PHP-код, лучше выбирать `.html`, т.к. он загружается быстрее, потому что PHP его не обрабатывает.

## Раздел инициализации

Во фреймворке не используется MVC, но все же нужно откуда-то брать и проверять данные. Виды условно разделяются на два раздела: **инициализация** и **верстка**. При этом, **инициализация выносится в начало вида, а верстка следует за ним.**

В терминах MVC, в **инициализацию** выносится код из контроллера. Так как контроллеры в MVC должны быть "тонкими" (содержать немного строк кода), для раздела **инициализации** распространяются те же правила (иначе будет слишком много смешения PHP и HTML).

Архитектура фреймворка устроена так, чтобы получение нужных данных в любой части приложения занимало минимальное количество строк. Поэтому виды обычно будут походить на пример ниже.

```php
<?php /** @var frame\views\Page $self */

use frame\tools\Init;
use engine\users\User;

// Если пользователь не авторизован, возникнет ошибка 403.
Init::accessLogin();
// Если GET-параметра id нет, возникнет ошибка 404.
$id = Init::requireGet('id');
// Ищем в БД пользователя по его ID.
$user = User::find($id);
// Если пользователь не найден (null), возникнет ошибка 404.
Init::require($user !== null);
?>

<!-- HTML-код -->
Hello <?= $user->login ?>
```

Как и в MVC, следует выносить всю сложную логику в модели или другие вспомогательные классы.

# По необходимости

## Создание новой страницы

В директории `views/pages` добавить файл с именем будущей страницы. Адреса страниц соответствуют расположению их файлов в иерархии директории `views/pages`. Поддерживаются форматы `.php` и `.html`.

```bash
# Примеры расположения файлов видов страниц и адресов к ним.

views
|- pages
   |-- articles
       |-- item.html # site.com/articles/item
   |-- users.php # site.com/users
```

### Страницы с пустыми именами

Имя файла может быть пустым (содержать только формат). Тогда и имя страницы будет пустым. Если разместить такой файл в корень директории со страницами, можно создать главную страницу сайта.

```bash
views
|- pages
   |-- .php # site.com (главная страница)
```

## Обращение к экземпляру вида из его файла

Внутрь файла вида передается переменная `$self`, которая ссылается на объект вида. В зависимости от типа вида, переменная может быть разного типа. Для страницы это `frame\views\Page`, для компоновщика - `frame\views\Layout` и т.д. Общий вид имеет тип `frame\views\View`.

Для поддержки автодополнения IDE стоит указать эту переменную в самом начале файла с помощью `doc`-комментария:

```php
// Для страницы:
/** @var frame\views\Page $self */

// Для виджета:
/** @var frame\views\Widget $self */

// И т.д. в зависимости от типа вида.

// Пример использования:
$self->setMeta('key', 'value');
```

*Вызывать можно только публичные свойства и методы.*

## Подключение вида изнутри другого вида

При подключении указывается только имя вида. Формат будет определен сам.

```php
<?php /** @var frame\views\View $self */

use frame\views\Widget;
use frame\views\Block;

// Находится в views/widgets/mini-profile.php
(new Widget('mini-profile'))->show();

// Находится в views/blocks/admin-panel/menu.html
(new Block('admin-panel/menu'))->show();

// И т.д.
```

## Виды общего типа

Обычно используется для того, чтобы подключать виды, не ограничиваясь рамками конкретных типов. Например, `блоки` находятся в директории `views/blocks` и при подключении блока (`Block`), вид будет искаться только в этой директории. При использовании общих видов, имя его имя указывается, начиная с корневой директории видов `views`.

```php
<?php /** @var frame\views\View $self */

use frame\views\View;

// Находится в views/special-dir/my-view.php
(new View('special-dir/my-view'))->show();
```